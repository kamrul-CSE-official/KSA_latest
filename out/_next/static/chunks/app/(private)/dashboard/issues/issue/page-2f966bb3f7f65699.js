(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4465],{17313:(e,s,t)=>{"use strict";t.d(s,{Xi:()=>o,av:()=>c,j7:()=>d,tU:()=>r});var a=t(22342),l=t(33670),i=t(60704),n=t(59434);let r=i.bL,d=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)(i.B8,{ref:s,className:(0,n.cn)("inline-flex h-9 items-center justify-center rounded-lg bg-muted p-1 text-muted-foreground",t),...l})});d.displayName=i.B8.displayName;let o=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)(i.l9,{ref:s,className:(0,n.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-md px-3 py-1 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow",t),...l})});o.displayName=i.l9.displayName;let c=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)(i.UC,{ref:s,className:(0,n.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",t),...l})});c.displayName=i.UC.displayName},22346:(e,s,t)=>{"use strict";t.d(s,{w:()=>n});var a=t(22342);t(33670);var l=t(87489),i=t(59434);function n(e){let{className:s,orientation:t="horizontal",decorative:n=!0,...r}=e;return(0,a.jsx)(l.b,{"data-slot":"separator-root",decorative:n,orientation:t,className:(0,i.cn)("bg-border shrink-0 data-[orientation=horizontal]:h-px data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-px",s),...r})}},39440:(e,s,t)=>{"use strict";t.d(s,{WT:()=>l,_L:()=>a,vD:()=>r});let{useLoginMutation:a,useUserDeatilsMutation:l,useSuggestForTagMutation:i,useSearchEmployMutation:n,useGetEmpMutation:r}=t(79606).A.injectEndpoints({endpoints:e=>({login:e.mutation({query:e=>({url:"/Login/IsValidUserWithJWTToken",method:"POST",body:e})}),userDeatils:e.mutation({query:e=>({url:"/User/GetRequesterDetails",method:"POST",body:e})}),suggestForTag:e.mutation({query:e=>({url:"/KSA/getSuggestPesson",method:"POST",body:e})}),searchEmploy:e.mutation({query:e=>({url:"/User/GetRequesterDetails",method:"POST",body:e})}),getEmp:e.mutation({query:e=>({url:"/KSA/getEmpProfile",method:"POST",body:e})})})})},44838:(e,s,t)=>{"use strict";t.d(s,{SQ:()=>d,_2:()=>o,lp:()=>c,mB:()=>u,rI:()=>n,ty:()=>r});var a=t(22342);t(33670);var l=t(48698),i=t(59434);function n(e){let{...s}=e;return(0,a.jsx)(l.bL,{"data-slot":"dropdown-menu",...s})}function r(e){let{...s}=e;return(0,a.jsx)(l.l9,{"data-slot":"dropdown-menu-trigger",...s})}function d(e){let{className:s,sideOffset:t=4,...n}=e;return(0,a.jsx)(l.ZL,{children:(0,a.jsx)(l.UC,{"data-slot":"dropdown-menu-content",sideOffset:t,className:(0,i.cn)("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 max-h-(--radix-dropdown-menu-content-available-height) min-w-[8rem] overflow-x-hidden overflow-y-auto rounded-md border p-1 shadow-md",s),...n})})}function o(e){let{className:s,inset:t,variant:n="default",...r}=e;return(0,a.jsx)(l.q7,{"data-slot":"dropdown-menu-item","data-inset":t,"data-variant":n,className:(0,i.cn)("focus:bg-accent focus:text-accent-foreground data-[variant=destructive]:text-destructive-foreground data-[variant=destructive]:focus:bg-destructive/10 dark:data-[variant=destructive]:focus:bg-destructive/40 data-[variant=destructive]:focus:text-destructive-foreground data-[variant=destructive]:*:[svg]:!text-destructive-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",s),...r})}function c(e){let{className:s,inset:t,...n}=e;return(0,a.jsx)(l.JU,{"data-slot":"dropdown-menu-label","data-inset":t,className:(0,i.cn)("px-2 py-1.5 text-sm font-medium data-[inset]:pl-8",s),...n})}function u(e){let{className:s,...t}=e;return(0,a.jsx)(l.wv,{"data-slot":"dropdown-menu-separator",className:(0,i.cn)("bg-border -mx-1 my-1 h-px",s),...t})}},46102:(e,s,t)=>{"use strict";t.d(s,{Bc:()=>n,ZI:()=>o,k$:()=>d,m_:()=>r});var a=t(22342);t(33670);var l=t(83921),i=t(59434);function n(e){let{delayDuration:s=0,...t}=e;return(0,a.jsx)(l.Kq,{"data-slot":"tooltip-provider",delayDuration:s,...t})}function r(e){let{...s}=e;return(0,a.jsx)(n,{children:(0,a.jsx)(l.bL,{"data-slot":"tooltip",...s})})}function d(e){let{...s}=e;return(0,a.jsx)(l.l9,{"data-slot":"tooltip-trigger",...s})}function o(e){let{className:s,sideOffset:t=0,children:n,...r}=e;return(0,a.jsx)(l.ZL,{children:(0,a.jsxs)(l.UC,{"data-slot":"tooltip-content",sideOffset:t,className:(0,i.cn)("bg-primary text-primary-foreground animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-fit rounded-md px-3 py-1.5 text-xs text-balance",s),...r,children:[n,(0,a.jsx)(l.i3,{className:"bg-primary fill-primary z-50 size-2.5 translate-y-[calc(-50%_-_2px)] rotate-45 rounded-[2px]"})]})})}},62136:(e,s,t)=>{"use strict";t.d(s,{Y:()=>m,w:()=>u});var a=t(8777),l=t.n(a),i=t(2829),n=t(49641).Buffer;let r="aes-256-cbc",d=l().createHash("sha256").update(String((0,i.rJ)())).digest("base64").substring(0,32);function o(e){return e.toString("base64").replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}function c(e){for(e=e.replace(/-/g,"+").replace(/_/g,"/");e.length%4!=0;)e+="=";return n.from(e,"base64")}function u(e){let s=l().randomBytes(16),t=l().createCipheriv(r,d,s),a=n.concat([t.update(String(e),"utf8"),t.final()]);return"".concat(o(s),".").concat(o(a))}function m(e){let[s,t]=String(e).split(".");if(!s||!t)throw Error("Invalid encrypted string");let a=c(s),i=c(t),o=l().createDecipheriv(r,d,a);return n.concat([o.update(i),o.final()]).toString("utf8")}},68856:(e,s,t)=>{"use strict";t.d(s,{E:()=>i});var a=t(22342),l=t(59434);function i(e){let{className:s,...t}=e;return(0,a.jsx)("div",{"data-slot":"skeleton",className:(0,l.cn)("bg-primary/10 animate-pulse rounded-md",s),...t})}},80697:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>ey});var a=t(22342),l=t(33670),i=t(35695),n=t(6874),r=t.n(n),d=t(52243),o=t(91394),c=t(26126),u=t(30285),m=t(66695),x=t(54165),h=t(62525),p=t(1243),f=t(47201),v=t(34540),g=t(57114),j=t(35169),b=t(74783),N=t(69074),y=t(92657),S=t(46102),w=t(56671),I=t(73783),E=t(47924),T=t(54416),D=t(60760),k=t(39440),A=t(62136),C=t(62523),_=t(17313),L=t(68856);let P=e=>{let{children:s}=e,[t,n]=(0,l.useState)(!1),[r,m]=(0,l.useState)(""),[h,p]=(0,l.useState)([]),g=(0,v.d4)(e=>e.user.userData),j=(0,i.useSearchParams)(),b=(0,A.Y)(j.get("issueId")||""),[N,{isLoading:y}]=(0,f.pK)(),[P,{isLoading:U,data:M}]=(0,k.vD)(),R=(0,l.useCallback)(async()=>{try{let e=await N({Type:3,PersonID:null==g?void 0:g.EmpID,IssueId:b,StatusID:1});if(e.data){let s=new Set,t=e.data.reduce((e,t)=>(s.has(t.PersonID)||(s.add(t.PersonID),e.push({EMP_ID:t.PersonID,PersonName:t.FULL_NAME,ITEM_IMAGE:t.IMAGE})),e),[]);p(t)}else w.oR.error("Failed to fetch shared users")}catch(e){w.oR.error("Error fetching shared users")}},[N,null==g?void 0:g.EmpID,b]),z=(0,l.useCallback)(()=>{if(!g)return;let{SectionID:e="",DepartmentID:s=""}=g;P({EmpID:"",Name:"",SectionID:e,DepartmentID:s,Page:1,Limit:6})},[P,g]);(0,l.useEffect)(()=>{g&&(z(),R())},[g,z,R]);let O=e=>{m(e),P({EmpID:isNaN(Number(e))?"":e,Name:isNaN(Number(e))?e:"",SectionID:"",DepartmentID:"",Page:1,Limit:6})},F=async e=>{let s=h.some(s=>s.EMP_ID===e.EmpID);await N({Type:2,PersonID:e.EmpID,IssueId:b,StatusID:1}),s||p(s=>[...s,{EMP_ID:e.EmpID,PersonName:e.Name,ITEM_IMAGE:e.Image}])},q=async e=>{await N({Type:1,PersonID:e.EMP_ID,IssueId:b,StatusID:1}),p(s=>s.filter(s=>s.EMP_ID!==e.EMP_ID))};return(0,a.jsxs)(x.lG,{open:t,onOpenChange:n,children:[(0,a.jsx)(x.zM,{asChild:!0,children:s}),(0,a.jsxs)(x.Cf,{className:"w-full max-w-3xl max-h-[90vh] flex flex-col p-0 overflow-hidden",children:[(0,a.jsx)(x.c7,{className:"px-6 pt-6 pb-4 border-b",children:(0,a.jsx)("div",{className:"flex items-center justify-between",children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)(I.A,{className:"h-5 w-5 text-primary"}),(0,a.jsx)(x.L3,{className:"text-lg font-semibold",children:"Issue Manage"})]})})}),(0,a.jsxs)(_.tU,{defaultValue:"share",className:"w-full flex flex-col h-full",children:[(0,a.jsxs)(_.j7,{className:"grid grid-cols-2 border-b px-6 bg-transparent rounded-none",children:[(0,a.jsx)(_.Xi,{value:"share",className:"py-4",children:"Share with People"}),(0,a.jsx)(_.Xi,{value:"visibility",className:"py-4 hidden",children:"Visibility Settings"})]}),(0,a.jsxs)(_.av,{value:"share",className:"flex-1 overflow-auto px-6 py-4",children:[(0,a.jsxs)("div",{className:"relative mb-4",children:[(0,a.jsx)(E.A,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,a.jsx)(C.p,{placeholder:"Search by name or ID...",value:r,onChange:e=>O(e.target.value),className:"pl-9 w-full"})]}),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("h3",{className:"font-medium mb-3",children:["Suggested People ",h.length]}),(0,a.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:U?Array.from({length:4}).map((e,s)=>(0,a.jsx)(d.P.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.1*s},children:(0,a.jsxs)("div",{className:"flex items-center gap-3 p-3 border rounded-lg",children:[(0,a.jsx)(L.E,{className:"w-10 h-10 rounded-full"}),(0,a.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,a.jsx)(L.E,{className:"h-4 w-3/4"}),(0,a.jsx)(L.E,{className:"h-3 w-1/2"})]})]})},s)):(null==M?void 0:M.length)?M.map((e,s)=>(0,a.jsx)(d.P.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.05*s},whileHover:{scale:1.02},whileTap:{scale:.98},children:(0,a.jsxs)("div",{onClick:()=>F(e),className:"flex items-center gap-3 p-3 border rounded-lg shadow-sm cursor-pointer hover:bg-muted transition",children:[(0,a.jsxs)(o.eu,{className:"w-10 h-10 border",children:[(0,a.jsx)(o.BK,{src:"data:image/jpeg;base64,".concat(e.Image),alt:e.Name}),(0,a.jsx)(o.q5,{children:e.Name.slice(0,2)})]}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("p",{className:"font-medium truncate",children:e.Name}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground truncate",children:e.DesignationName})]}),(0,a.jsx)(u.$,{size:"sm",variant:"outline",className:"shrink-0",children:"Add"})]})},e.EmpID)):(0,a.jsxs)(d.P.div,{initial:{opacity:0},animate:{opacity:1},className:"col-span-2 py-8 flex flex-col items-center gap-2 text-muted-foreground",children:[(0,a.jsx)(E.A,{className:"h-8 w-8"}),(0,a.jsx)("p",{children:r?"No results found":"Search for people to share with"})]})})]}),h.length>0&&(0,a.jsxs)(d.P.div,{initial:{opacity:0},animate:{opacity:1},className:"border-t pt-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,a.jsx)("h3",{className:"font-medium",children:"Shared With"}),(0,a.jsxs)(c.E,{variant:"secondary",children:[h.length," people"]})]}),(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:(0,a.jsx)(D.N,{children:h.map(e=>(0,a.jsx)(d.P.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},layout:!0,children:(0,a.jsx)(S.Bc,{children:(0,a.jsxs)(S.m_,{children:[(0,a.jsx)(S.k$,{asChild:!0,children:(0,a.jsxs)("div",{className:"flex items-center gap-2 border rounded-full pl-2 pr-1 py-1 bg-muted/30 hover:bg-muted/50 transition-colors",children:[(0,a.jsxs)(o.eu,{className:"h-6 w-6",children:[(0,a.jsx)(o.BK,{src:"data:image/jpeg;base64,".concat(e.ITEM_IMAGE),alt:e.PersonName}),(0,a.jsx)(o.q5,{children:e.PersonName.slice(0,2)})]}),(0,a.jsx)("p",{className:"text-sm truncate max-w-[100px]",children:e.PersonName}),(0,a.jsx)(u.$,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:()=>q(e),children:(0,a.jsx)(T.A,{className:"h-4 w-4"})})]})}),(0,a.jsx)(S.ZI,{children:(0,a.jsx)("p",{children:e.PersonName})})]})})},e.EMP_ID))})})]})]})]}),(0,a.jsx)(_.av,{value:"visibility",children:(0,a.jsx)("div",{className:"px-6 py-4 text-muted-foreground",children:"Coming soon: Manage issue visibility settings."})})]})]})]})};t(19734),t(29639),t(86818),t(85020),t(95162),t(65219),t(12614),t(40686),t(56581),t(81863),t(51062),t(75710),t(91607),t(11067),t(37863),t(14756);var U=t(50462),M=t(57434),R=t(91788);let z=e=>{let{attachment:s}=e;return s?(0,a.jsx)(m.Zp,{className:"border-dashed border-2 hover:border-primary/50 transition-colors",children:(0,a.jsx)(m.Wu,{className:"p-4",children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[((e,s)=>(null==e?void 0:e.includes("pdf"))?(0,a.jsx)(M.A,{className:"h-5 w-5 text-red-500"}):(null==e?void 0:e.includes("image"))?(0,a.jsx)("img",{src:s.FilePath,alt:s.FileType,className:"h-5 w-5 text-blue-500"}):(0,a.jsx)(M.A,{className:"h-5 w-5 text-gray-500"}))(s.FileType,s),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("p",{className:"font-medium text-sm truncate",children:(e=>(null==e?void 0:e.includes("pdf"))?"PDF Document":(null==e?void 0:e.includes("image"))?"Image File":"File")(s.FileType)}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:s.FileType})]}),(0,a.jsx)(u.$,{size:"sm",variant:"outline",asChild:!0,children:(0,a.jsxs)(r(),{href:s.FilePath,target:"_blank",className:"gap-2",children:[(0,a.jsx)(R.A,{className:"h-4 w-4"}),"View"]})})]})})}):null};function O(e){var s,t,n,w,I,E;let{issue:T,numberOfSolutions:D,sharedUsers:k,setIsUpdate:A,isUpdate:C}=e,_=(0,i.useRouter)(),L=T[0],[M,R]=(0,l.useState)(!1),[O,F]=(0,l.useState)(1),[q,$]=(0,l.useState)(!1),B=(0,v.d4)(e=>e.user.userData),[J,{isLoading:K}]=(0,f.RJ)(),[G,{data:Y}]=(0,f.Jf)();(0,l.useEffect)(()=>{G({ParentID:L.ID})},[G,T]);let[W,{isLoading:H}]=(0,f.ES)(),[Z,V]=(0,l.useState)(L.CONTENT),[Q,X]=(0,l.useState)(!1),[ee,es]=(0,l.useState)(!1);(0,l.useEffect)(()=>{X(Z!==L.CONTENT)},[Z,L.CONTENT]);let et=async()=>{try{await W({ISSUE_ID:L.ID,CONTENT:Z,USER_ID:null==B?void 0:B.EmpID,Type:1})&&X(!1)}catch(e){console.error("Error updating issue content:",e)}},ea=async()=>{try{es(!0),await W({ISSUE_ID:L.ID,CONTENT:"",USER_ID:null==B?void 0:B.EmpID,Type:2})&&_.push("/dashboard/issues/")}catch(e){console.error("Error deleting issue:",e),es(!1)}};return((0,l.useEffect)(()=>{(async function(){try{let e=await J({Type:2,ISSUES_ID:L.ID});if(null==e?void 0:e.data)e.data.map(e=>({...e,reviews:["55","56"],replies:["12","11"]}))}catch(e){throw console.error("Error managing solutions:",e),e}})()},[]),L)?(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)(r(),{href:"/dashboard/issues/",className:"inline-flex items-center text-sm text-muted-foreground hover:text-foreground mb-6 transition-colors",children:[(0,a.jsx)(j.A,{className:"mr-2 h-4 w-4"}),"Back to all Incident"]}),(null==L?void 0:null===(t=L.TAG_LIST)||void 0===t?void 0:null===(s=t.split(","))||void 0===s?void 0:s.length)&&(null==L?void 0:null===(w=L.TAG_LIST)||void 0===w?void 0:null===(n=w.split(","))||void 0===n?void 0:n.length)>0&&(0,a.jsx)(d.P.div,{initial:{opacity:0,y:5},animate:{opacity:1,y:0},transition:{delay:.1},className:"flex flex-wrap gap-2 mb-4",children:null==L?void 0:null===(I=L.TAG_LIST)||void 0===I?void 0:I.split(",").map(e=>(0,a.jsx)(c.E,{variant:"secondary",className:"px-3 py-1 text-xs",children:e},e))}),(0,a.jsxs)(d.P.div,{initial:{opacity:0,y:5},animate:{opacity:1,y:0},"data-view-transition-name":"page-title",className:"text-3xl font-bold mb-4 leading-tight flex items-center justify-between",children:[L.TITLE," ",(0,a.jsxs)("div",{className:"flex items-center justify-center gap-1",children:[(0,a.jsx)("div",{className:"flex -space-x-1 overflow-hidden",children:null==k?void 0:k.map((e,s)=>(0,a.jsx)("img",{alt:e.FULL_NAME,src:"data:image/jpeg;base64,"+e.IMAGE,className:"inline-block size-6 rounded-full ring-2 ring-white"},s))}),(null==B?void 0:B.EmpID)==L.USER_ID&&(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)(x.lG,{open:q,onOpenChange:$,children:[(0,a.jsx)(x.zM,{asChild:!0,children:(0,a.jsx)(u.$,{variant:"destructive",size:"sm",children:(0,a.jsx)(h.A,{className:"h-4 w-4"})})}),(0,a.jsxs)(x.Cf,{children:[(0,a.jsxs)(x.c7,{children:[(0,a.jsxs)(x.L3,{className:"flex items-center gap-2",children:[(0,a.jsx)(p.A,{className:"h-5 w-5 text-destructive"}),"Delete Issue"]}),(0,a.jsx)(x.rr,{children:"Are you sure you want to delete this issue? This action cannot be undone."})]}),(0,a.jsxs)(x.Es,{className:"gap-2 sm:justify-end",children:[(0,a.jsx)(u.$,{variant:"outline",onClick:()=>$(!1),children:"Cancel"}),(0,a.jsx)(u.$,{variant:"destructive",onClick:ea,disabled:ee,children:ee?"Deleting...":"Delete Issue"})]})]})]}),(0,a.jsx)(P,{refreshTrigger:O,setRefreshTrigger:F,children:(0,a.jsx)(u.$,{size:"sm",children:(0,a.jsx)(b.A,{})})})]})]})]}),(0,a.jsxs)("div",{className:"flex flex-wrap items-center gap-x-6 gap-y-2 text-sm text-muted-foreground mb-6",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)(o.eu,{className:"h-6 w-6 border",children:[(0,a.jsx)(o.BK,{src:"data:image/jpeg;base64,".concat(null==L?void 0:L.IMAGE),alt:(null==L?void 0:L.FULL_NAME)||"User"}),(0,a.jsx)(o.q5,{children:(null==L?void 0:null===(E=L.FULL_NAME)||void 0===E?void 0:E[0])||"U"})]}),(0,a.jsx)("span",{className:"font-medium text-foreground",children:null==L?void 0:L.FULL_NAME})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(N.A,{className:"h-4 w-4"}),(0,a.jsx)(S.Bc,{children:(0,a.jsxs)(S.m_,{children:[(0,a.jsx)(S.k$,{asChild:!0,children:(0,a.jsx)("span",{children:L.CREATED_AT})}),(0,a.jsx)(S.ZI,{children:L.CREATED_AT})]})})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(y.A,{className:"h-4 w-4"}),(0,a.jsxs)("span",{children:[L.VIEWS_COUNT||0," Times views"]})]})]})]}),(0,a.jsxs)(m.Zp,{className:"overflow-hidden border-border/60",children:[(0,a.jsx)(m.Wu,{className:"pt-4",children:(0,a.jsx)(l.Suspense,{fallback:(0,a.jsx)(U.A,{}),children:(null==B?void 0:B.EmpID)==L.USER_ID?(0,a.jsxs)(d.P.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.2},className:"prose dark:prose-invert max-w-none",children:[(0,a.jsx)(g.K,{tinymceScriptSrc:"/tinymce/tinymce.min.js",value:Z,onEditorChange:e=>{V(e)},init:{statusbar:!1,skin:!1,content_css:!1,height:1e3,plugins:["advlist","autolink","lists","link","image","charmap","preview","anchor","searchreplace","visualblocks","code","fullscreen","insertdatetime","media","table","help","wordcount","emoticons","codesample","textpattern","tablemerge"],toolbar:"undo redo | blocks | bold italic forecolor backcolor | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | link image media table emoticons codesample | removeformat help code fullscreen preview",content_style:"body { font-family:Helvetica,Arial,sans-serif; font-size:16px; padding: 1rem; }"}}),(0,a.jsx)("div",{className:"mt-4 flex justify-end",children:(0,a.jsx)(u.$,{onClick:et,disabled:H||!Q,children:H?"Saving...":"Save Changes"})})]}):(0,a.jsx)(d.P.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.2},className:"prose dark:prose-invert max-w-none",children:(0,a.jsx)("div",{dangerouslySetInnerHTML:{__html:Z}})})})}),(0,a.jsx)(m.wL,{className:"border-t p-4 bg-muted/20 w-full flex flex-wrap items-center justify-center gap-2",children:(0,a.jsxs)("div",{className:"w-full space-y-3",children:[(0,a.jsx)("h3",{className:"font-semibold text-sm",children:"Attachments"}),null==Y?void 0:Y.map(e=>(0,a.jsx)(z,{attachment:e}))]})})]}),(0,a.jsx)("br",{})]}):(0,a.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,a.jsx)("p",{children:"Issue not found"})})}var F=t(22346),q=t(51154),$=t(44838),B=t(59434),J=t(57340),K=t(94498),G=t(21380),Y=t(2775),W=t(84616);let H=e=>({"Root Cause":J.A,Assumption:K.A,Claim:M.A,Opinion:G.A,Conclusion:Y.A})[e]||G.A,Z=["Root Cause","Assumption","Claim","Opinion","Conclusion"],V=e=>{var s,t,n,r,d;let{className:o,setLeftNavState:m,leftNavState:x,sulations:h,numberOfSulation:p,issue:g,setIsUpdate:j,isUpdate:b}=e,N=Z.map(e=>({label:e,href:"#",icon:H(e)})),[y,{isLoading:S,data:w}]=(0,f.pK)(),[I,{data:E}]=(0,f.RJ)(),T=(0,v.d4)(e=>e.user.userData),D=(0,i.useSearchParams)(),k=(0,A.Y)((null==D?void 0:D.get("issueId"))||"");(0,l.useEffect)(()=>{k&&(null==T?void 0:T.EmpID)&&(y({Type:3,PersonID:T.EmpID,IssueId:k,StatusID:1}),I({Type:12,ISSUES_ID:k,USER_ID:T.EmpID}))},[k,T,y,I]);let C=null==w?void 0:w.find(e=>e.PersonID===(null==T?void 0:T.EmpID)||e.CreatorID===(null==T?void 0:T.EmpID)),_=(null==E?void 0:null===(s=E.filter(e=>(null==e?void 0:e.STATUS)===5)[0])||void 0===s?void 0:s.Type)||0,L=(null==E?void 0:null===(t=E.filter(e=>(null==e?void 0:e.STATUS)===6)[0])||void 0===t?void 0:t.Type)||0,P=(null==E?void 0:null===(n=E.filter(e=>(null==e?void 0:e.STATUS)===7)[0])||void 0===n?void 0:n.Type)||0,U=(null==E?void 0:null===(r=E.filter(e=>(null==e?void 0:e.STATUS)===8)[0])||void 0===r?void 0:r.Type)||0,M=(null==E?void 0:null===(d=E.filter(e=>(null==e?void 0:e.STATUS)===9)[0])||void 0===d?void 0:d.Type)||0,R={[Z[0]]:_,[Z[1]]:L,[Z[2]]:P,[Z[3]]:U,[Z[4]]:M};return(0,a.jsx)("div",{className:(0,B.cn)("w-full border-b bg-background/95 backdrop-blur",o),children:(0,a.jsxs)("div",{className:"flex items-center justify-between py-3",children:[(0,a.jsx)("nav",{className:"flex items-center space-x-1 overflow-x-auto",children:N.map((e,s)=>(0,a.jsxs)(u.$,{onClick:()=>m(s),variant:x===s?"secondary":"ghost",size:"sm",className:"flex items-center gap-2 whitespace-nowrap",children:[(0,a.jsx)(e.icon,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"hidden sm:inline",children:e.label}),(0,a.jsx)(c.E,{children:R[e.label]||0})]},e.label))}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[S&&(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:"Loading..."}),C&&(0,a.jsxs)($.rI,{children:[(0,a.jsx)($.ty,{asChild:!0,children:(0,a.jsxs)(u.$,{size:"sm",className:"flex items-center gap-2",children:[(0,a.jsx)(W.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"hidden sm:inline",children:"Add"})]})}),(0,a.jsx)($.SQ,{className:"w-56",align:"end",children:N.map((e,s)=>(0,a.jsxs)($._2,{onClick:()=>m(N.length+s),children:[(0,a.jsx)(e.icon,{className:"mr-2 h-4 w-4 text-muted-foreground"}),e.label]},e.label))})]})]})]})})};var Q=t(27750);function X(e){let{className:s,...t}=e;return(0,a.jsx)(Q.bL,{"data-slot":"menubar",className:(0,B.cn)("bg-background flex h-9 items-center gap-1 rounded-md border p-1 shadow-xs",s),...t})}function ee(e){let{...s}=e;return(0,a.jsx)(Q.W1,{"data-slot":"menubar-menu",...s})}function es(e){let{className:s,...t}=e;return(0,a.jsx)(Q.l9,{"data-slot":"menubar-trigger",className:(0,B.cn)("focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground flex items-center rounded-sm px-2 py-1 text-sm font-medium outline-hidden select-none",s),...t})}let et=e=>{let{setTopNavState:s,topNavState:t,issueId:i,updateSulation:n,setDptSearch:r,dptSearch:d,searchDeptmentWise:o}=e,[c,{isLoading:u,data:m}]=(0,f.RJ)();return(0,l.useEffect)(()=>{c({Type:5,ISSUES_ID:i})},[i,n]),(0,a.jsxs)("nav",{className:"border-b",children:[u&&(0,a.jsx)("p",{children:"Loading..."}),(0,a.jsx)(X,{className:"rounded-none border-b-0",children:null==m?void 0:m.map((e,l)=>(0,a.jsx)(ee,{children:(0,a.jsx)(es,{onClick:()=>{s(l),r(e.DEPTNAME),o(e.DEPTNAME)},className:(0,B.cn)("cursor-pointer",t===l&&"bg-muted font-semibold"),children:e.DEPTNAME})},l))})]})};var ea=t(85057),el=t(88539),ei=t(53311),en=t(95619);function er(e){let{content:s,onChange:t,placeholder:i}=e,n=(0,l.useRef)(null),[r,d]=(0,l.useState)(""),[o,{isLoading:c,data:u=[]}]=(0,f.LI)();u.filter(e=>e.name.toLowerCase().includes(r.toLowerCase())),(0,l.useEffect)(()=>{r&&o({SearchKey:r})},[r,o]);let m=(0,l.useCallback)((e,s)=>{n.current=s,s.on("keydown",e=>{"@"===e.key&&(e.preventDefault(),d(""))})},[]);return(0,a.jsx)("div",{className:"relative rounded-lg border bg-background shadow-sm",children:(0,a.jsx)(l.Suspense,{fallback:(0,a.jsx)("p",{children:"Loading..."}),children:(0,a.jsx)(g.K,{tinymceScriptSrc:"/tinymce/tinymce.min.js",onInit:m,value:s,init:{statusbar:!1,skin:!1,content_css:!1,branding:!1,height:595,menubar:!1,disabled:!1,plugins:["advlist","autolink","lists","link","image","charmap","preview","anchor","searchreplace","visualblocks","code","fullscreen","insertdatetime","media","table","help","wordcount","emoticons"],toolbar:"undo redo | blocks fontfamily | bold italic underline strikethrough | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | link image media table | removeformat | help",content_style:"\n              body { \n                font-family: Inter, system-ui, sans-serif; \n                font-size: 14px; \n                line-height: 1.5;\n                padding: 12px;\n              }\n              .mention {\n                background: #e0f2fe;\n                color: #0369a1;\n                border-radius: 4px;\n                padding: 0 4px;\n                font-weight: 500;\n              }\n              img {\n                max-width: 100%;\n                height: auto;\n              }\n              table {\n                border-collapse: collapse;\n                width: 100%;\n              }\n              table, th, td {\n                border: 1px solid #e2e8f0;\n              }\n              th, td {\n                padding: 8px 12px;\n              }\n            ",image_advtab:!0,automatic_uploads:!0,file_picker_callback:e=>{let s=document.createElement("input");s.setAttribute("type","file"),s.setAttribute("accept","image/*"),s.onchange=()=>{var t;let a=null===(t=s.files)||void 0===t?void 0:t[0];if(!a)return;let l=new FileReader;l.onload=()=>{e(l.result,{title:a.name})},l.readAsDataURL(a)},s.click()},placeholder:i},onEditorChange:t})})})}let ed={5:"Add Root Cause",6:"Add Assumption",7:"Add Claim",8:"Add Opinion"},eo=e=>{var s;let{state:t,leftNavState:n,setLeftNavState:r,updateSulation:d,setUpdateSulation:o}=e,[c,m]=(0,l.useState)(""),[x,h]=(0,l.useState)(""),[p,g]=(0,l.useState)(""),[j,b]=(0,l.useState)({}),[N,{isLoading:y}]=(0,f.RJ)(),S=(0,v.d4)(e=>e.user.userData),w=(0,i.useSearchParams)(),I=(0,A.Y)((null==w?void 0:w.get("issueId"))||"")||"",E=(e,s)=>{"title"===e?m(s):"summary"===e&&h(s)},T=e=>{"title"!==e||c.trim()?"summary"!==e||x.trim()?b(s=>({...s,[e]:void 0})):b(e=>({...e,summary:"Summary is required."})):b(e=>({...e,title:"Title is required."}))},D=async()=>{let e=!!c.trim(),s=!!x.trim();if(!e||!s){b({title:e?void 0:"Title is required.",summary:s?void 0:"Summary is required."});return}await N({ISSUES_ID:I,Type:3,USER_ID:null==S?void 0:S.EmpID,TITLE:c,CONTENT:p,COMPANY_ID:null==S?void 0:S.CompanyID,Summary:x,STATUS:n}).then(e=>{var s,t;(null==e?void 0:null===(s=e.data[0])||void 0===s?void 0:s.ISSUES_ID)&&(null==e?void 0:null===(t=e.data[0])||void 0===t?void 0:t.TITLE)&&(r(0),o(d+1))})};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)("h1",{className:"text-5xl font-bold",children:null!==(s=ed[t])&&void 0!==s?s:"Add Conclusion"}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)(ea.J,{htmlFor:"title",className:"text-lg font-semibold text-slate-700",children:"Title *"}),(0,a.jsx)(C.p,{type:"text",id:"title",value:c,placeholder:"Provide a title...",onChange:e=>E("title",e.target.value),onBlur:()=>T("title"),className:"w-full px-3 py-2 border rounded-md text-base ".concat(j.title?"border-red-300 focus:ring-red-200":"border-slate-300 focus:ring-blue-200"),required:!0}),j.title&&(0,a.jsx)("p",{className:"text-sm text-red-500",children:j.title})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)(ea.J,{htmlFor:"summary",className:"text-lg font-semibold text-slate-700",children:"Quick Summary *"}),(0,a.jsx)(el.T,{id:"summary",value:x,placeholder:"Provide a brief summary of your issue...",onChange:e=>E("summary",e.target.value),onBlur:()=>T("summary"),className:"min-h-[100px] ".concat(j.summary?"border-red-300 focus:ring-red-200":"border-slate-300 focus:ring-blue-200"),required:!0}),j.summary&&(0,a.jsx)("p",{className:"text-sm text-red-500",children:j.summary})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)(ea.J,{className:"text-lg font-semibold text-slate-700 flex items-center gap-2",children:[(0,a.jsx)(ei.A,{className:"h-5 w-5 text-purple-500"}),"Quick Templates"]}),(0,a.jsx)(en.A,{onSelectTemplate:e=>{g(e)}})]}),(0,a.jsx)(er,{content:p,onChange:e=>g(e),placeholder:"Describe your issue in detail..."}),(0,a.jsx)("div",{className:"pt-4",children:(0,a.jsx)(u.$,{onClick:D,disabled:y,children:y?"Submitting...":"Submit"})})]})};var ec=t(82940),eu=t.n(ec),em=t(13717),ex=t(47863),eh=t(66474),ep=t(71007),ef=t(14186),ev=t(90010);let eg=function(e){var s,t;let{children:i,sulationId:n,setIsUpdateSulation:r}=e,[d,{data:o}]=(0,f.RJ)(),[c,m]=(0,l.useState)(""),[h,p]=(0,l.useState)(""),v=(0,l.useRef)(null);(0,l.useEffect)(()=>{d({ID:n,Type:10})},[n]),(0,l.useEffect)(()=>{(null==o?void 0:o[0])&&(m(o[0].TITLE||""),p(o[0].Summary||""))},[o]);let j=async()=>{var e,s;let t=(null===(s=v.current)||void 0===s?void 0:null===(e=s.getContent)||void 0===e?void 0:e.call(s))||"";await d({ID:n,Type:11,TITLE:c,Summary:h,CONTENT:t}),r(e=>e+1)};return(0,a.jsxs)(x.lG,{children:[(0,a.jsx)(x.zM,{children:i}),(0,a.jsxs)(x.Cf,{className:"max-w-[75rem] w-full max-h-[96vh] overflow-y-auto",children:[(0,a.jsx)(x.c7,{children:(0,a.jsxs)(x.L3,{children:["Update Solution #",n," ",null==o?void 0:null===(s=o[0])||void 0===s?void 0:s.TITLE]})}),(0,a.jsxs)("div",{className:"space-y-4 py-4",children:[(0,a.jsx)(C.p,{value:c,onChange:e=>m(e.target.value),placeholder:"Title"}),(0,a.jsx)(el.T,{value:h,onChange:e=>p(e.target.value),placeholder:"Summary",rows:4}),(0,a.jsx)(g.K,{tinymceScriptSrc:"/tinymce/tinymce.min.js",onInit:(e,s)=>v.current=s,initialValue:(null==o?void 0:null===(t=o[0])||void 0===t?void 0:t.CONTENT)||"",init:{height:400,menubar:!1,skin:!1,content_css:!1,branding:!1,statusbar:!1,plugins:["advlist","autolink","lists","link","image","charmap","preview","anchor","searchreplace","visualblocks","code","fullscreen","insertdatetime","media","table","help","wordcount","emoticons"],toolbar:"undo redo | blocks fontfamily | bold italic underline strikethrough | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | link image media table | removeformat | help",content_style:"\n                body {\n                  font-family: Inter, system-ui, sans-serif;\n                  font-size: 14px;\n                  line-height: 1.5;\n                  padding: 12px;\n                }\n                img {\n                  max-width: 100%;\n                  height: auto;\n                }\n                table {\n                  border-collapse: collapse;\n                  width: 100%;\n                }\n                table, th, td {\n                  border: 1px solid #e2e8f0;\n                }\n                th, td {\n                  padding: 8px 12px;\n                }\n              "}}),(0,a.jsx)("div",{className:"flex justify-end pt-4",children:(0,a.jsx)(u.$,{onClick:j,children:"Submit"})})]})]})]})},ej=e=>{var s,t;let{solution:i,setUpdateSulation:n}=e,[r,d]=(0,l.useState)(!1),x=(0,v.d4)(e=>e.user.userData),p=(e=>{let s=document.createElement("div");return s.innerHTML=e,s.textContent||s.innerText||""})(i.CONTENT).length>300,g=r?null!==(s=i.CONTENT)&&void 0!==s?s:"":((e,s)=>{let t=document.createElement("div");t.innerHTML=e;let a=t.textContent||t.innerText||"";if(a.length<=300)return e;let l=a.slice(0,300).length/a.length,i=Math.floor(e.length*l);return e.slice(0,i)+"..."})(null!==(t=i.CONTENT)&&void 0!==t?t:"",300),[j]=(0,f.RJ)(),b=e=>{j({Type:7,ID:e}),n(e=>e+1)};return(0,a.jsxs)(m.Zp,{className:"mb-6 overflow-hidden transition-all duration-300 hover:shadow-lg hover:shadow-blue-500/10 border-0 bg-gradient-to-br from-white to-gray-50/50 dark:from-gray-900 dark:to-gray-800/50",children:[(0,a.jsx)(m.aR,{className:"pb-3",children:(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h1",{className:"text-xl font-bold text-gray-900 dark:text-white mb-2 leading-tight",children:i.TITLE}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground leading-relaxed",children:i.Summary})]}),i.USER_ID==(null==x?void 0:x.EmpID)&&(0,a.jsxs)("div",{className:"flex gap-2 ml-4",children:[(0,a.jsx)(eg,{setIsUpdateSulation:n,sulationId:i.ID,children:(0,a.jsxs)(u.$,{size:"sm",variant:"outline",className:"h-8 px-3 bg-transparent",children:[(0,a.jsx)(em.A,{className:"h-3 w-3 mr-1"}),"Edit"]})}),(0,a.jsxs)(ev.Lt,{children:[(0,a.jsx)(ev.tv,{children:(0,a.jsxs)(u.$,{size:"sm",variant:"outline",className:"h-8 px-3 text-red-600 hover:text-red-700 hover:bg-red-50 bg-transparent",children:[(0,a.jsx)(h.A,{className:"h-3 w-3 mr-1"}),"Delete"]})}),(0,a.jsxs)(ev.EO,{children:[(0,a.jsxs)(ev.wd,{children:[(0,a.jsx)(ev.r7,{children:"Are you absolutely sure?"}),(0,a.jsx)(ev.$v,{children:"This action cannot be undone. This will permanently delete your account and remove your data from our servers."})]}),(0,a.jsxs)(ev.ck,{children:[(0,a.jsx)(ev.Zr,{children:"Cancel"}),(0,a.jsx)(ev.Rx,{className:"bg-red-500",onClick:()=>b(i.ID),children:"Continue"})]})]})]})]})]})}),(0,a.jsx)(m.Wu,{className:"pt-0",children:(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsxs)("div",{className:(0,B.cn)("prose prose-sm max-w-none transition-all duration-300","prose-headings:text-gray-900 dark:prose-headings:text-white","prose-p:text-gray-700 dark:prose-p:text-gray-300","prose-strong:text-gray-900 dark:prose-strong:text-white",!r&&p&&"relative overflow-hidden"),children:[(0,a.jsx)("div",{dangerouslySetInnerHTML:{__html:g},className:"leading-relaxed"}),!r&&p&&(0,a.jsx)("div",{className:"absolute bottom-0 left-0 right-0 h-12 bg-gradient-to-t from-white via-white/80 to-transparent dark:from-gray-900 dark:via-gray-900/80 pointer-events-none"})]}),p&&(0,a.jsx)(u.$,{variant:"ghost",size:"sm",onClick:()=>d(!r),className:"mt-3 h-8 px-3 text-blue-600 hover:text-blue-700 hover:bg-blue-50 dark:text-blue-400 dark:hover:text-blue-300 relative z-10",children:r?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(ex.A,{className:"h-3 w-3 mr-1"}),"Show Less"]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(eh.A,{className:"h-3 w-3 mr-1"}),"Read More"]})})]})}),(0,a.jsx)(F.w,{className:"mx-6"}),(0,a.jsx)(m.wL,{className:"pt-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between w-full",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsxs)(o.eu,{className:"h-10 w-10 ring-2 ring-blue-100 dark:ring-blue-900",children:[(0,a.jsx)(o.BK,{src:"data:image/jpeg;base64,".concat(i.IMAGE),alt:i.FULL_NAME}),(0,a.jsx)(o.q5,{className:"bg-gradient-to-br from-blue-500 to-purple-600 text-white font-semibold",children:i.FULL_NAME.split(" ").map(e=>e[0]).join("").slice(0,2)})]}),(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(ep.A,{className:"h-3 w-3 text-muted-foreground"}),(0,a.jsx)("span",{className:"font-medium text-gray-900 dark:text-white text-sm",children:i.FULL_NAME})]}),i.DEPTNAME&&(0,a.jsx)(c.E,{variant:"secondary",className:"w-fit mt-1 text-xs",children:i.DEPTNAME})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:[(0,a.jsx)(ef.A,{className:"h-3 w-3"}),(0,a.jsx)("span",{children:eu()(i.UPDATED_AT).format("DD MMM YYYY")})]})]})})]})},eb=["Root Causes","Assumptions","Claims","Opinions","Conclusions"],eN=e=>{let{issue:s,isUpdate:t,setIsUpdate:n}=e,r=(0,i.useSearchParams)(),d=(0,v.d4)(e=>e.user.userData),o=(0,l.useMemo)(()=>{let e=null==r?void 0:r.get("issueId");return e?(0,A.Y)(e):""},[r]),[c,u]=(0,l.useState)({topNavState:0,leftNavState:0,updateSulation:0,dptSearch:"",sulations:[]}),[m,{data:x,isLoading:h,error:p}]=(0,f.RJ)(),[g,{isLoading:j,error:b}]=(0,f.RJ)(),[N]=(0,f.pK)();(0,l.useEffect)(()=>{m({Type:4,ISSUES_ID:o})},[m,o]);let y=(0,l.useCallback)(e=>{u(s=>({...s,...e}))},[]),S=(0,l.useCallback)(async()=>{if(o)try{await m({Type:4,ISSUES_ID:o})}catch(e){console.error("Failed to fetch solution stats:",e)}},[m,o]),w=(0,l.useCallback)(async()=>{if(o)try{let e=await g({Type:6,ISSUES_ID:o,STATUS:c.leftNavState+5}).unwrap();y({sulations:e||[]})}catch(e){console.error("Failed to fetch solutions:",e),y({sulations:[]})}},[g,o,c.leftNavState,y]),I=(0,l.useCallback)(async e=>{if(o)try{let s=await g({Type:8,ISSUES_ID:o,STATUS:c.leftNavState+5,DEPTNAME:e}).unwrap();y({sulations:s||[]})}catch(e){console.error("Failed to search by department:",e),y({sulations:[]})}},[g,o,c.leftNavState,y]),E=(0,l.useCallback)(async()=>{if(o&&(null==d?void 0:d.EmpID))try{await N({Type:3,PersonID:d.EmpID,IssueId:o,StatusID:1})}catch(e){console.error("Failed to fetch issue share:",e)}},[N,o,null==d?void 0:d.EmpID]);(0,l.useEffect)(()=>{S()},[S,c.updateSulation]),(0,l.useEffect)(()=>{w()},[w,c.updateSulation]),(0,l.useEffect)(()=>{E()},[E]);let T=c.leftNavState>=5,D=(0,l.useCallback)(e=>{y({leftNavState:e})},[y]),k=(0,l.useCallback)(e=>{y({topNavState:e})},[y]),C=(0,l.useCallback)(e=>{y({updateSulation:c.updateSulation+e})},[y,c.updateSulation]),_=(0,l.useCallback)(e=>{y({dptSearch:e})},[y]),L=(0,l.useMemo)(()=>j?(0,a.jsxs)("div",{className:"flex items-center justify-center py-8",children:[(0,a.jsx)(q.A,{className:"h-6 w-6 animate-spin"}),(0,a.jsx)("span",{className:"ml-2 text-muted-foreground",children:"Loading solutions..."})]}):b?(0,a.jsx)("div",{className:"text-center py-8 text-red-500",children:"Failed to load solutions"}):c.sulations&&0!==c.sulations.length?(0,a.jsx)("div",{className:"space-y-4",children:c.sulations.map(e=>(0,a.jsx)(ej,{solution:e,setUpdateSulation:C},e.ID||"solution-".concat(Math.random())))}):(0,a.jsx)("div",{className:"text-center py-12",children:(0,a.jsx)("p",{className:"text-muted-foreground",children:"No solutions found"})}),[c.sulations,j,b,C]);return o?(0,a.jsxs)("div",{className:"min-h-screen w-full bg-background",children:[(0,a.jsx)(V,{isUpdate:t,setIsUpdate:n,numberOfSulation:x,leftNavState:c.leftNavState,setLeftNavState:D,sulations:c.sulations,issue:s}),!T&&(0,a.jsx)("header",{className:"sticky top-0 z-10 bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60 border-b",children:(0,a.jsx)(et,{searchDeptmentWise:I,setDptSearch:_,dptSearch:c.dptSearch,updateSulation:c.updateSulation,issueId:o,topNavState:c.topNavState,setTopNavState:k})}),(0,a.jsx)("main",{className:"flex-1",children:T?(0,a.jsx)("div",{children:(0,a.jsx)(eo,{setUpdateSulation:C,updateSulation:c.updateSulation,leftNavState:c.leftNavState,setLeftNavState:D,state:c.leftNavState})}):(0,a.jsx)("div",{className:"space-y-6 max-w-7xl mx-auto",children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:(0,a.jsx)("h3",{className:"text-xl font-bold",children:eb[c.leftNavState]||"Solutions"})}),(0,a.jsx)(F.w,{}),L]})})})]}):(0,a.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,a.jsx)("p",{className:"text-muted-foreground",children:"Invalid issue ID"})})};function ey(){let[e,s]=(0,l.useState)(0),t=(0,i.useSearchParams)(),n=(0,A.Y)((null==t?void 0:t.get("issueId"))||"")||"",d=(0,v.d4)(e=>e.user.userData),[o,{isLoading:c,data:u}]=(0,f.I7)(),[m,{isLoading:x,data:h}]=(0,f.RJ)(),[p,{data:g}]=(0,f.pK)(),{userData:b}=(0,v.d4)(e=>e.user);return((0,l.useEffect)(()=>{o({ID:n,USER_ID:null==b?void 0:b.EmpID}),p({Type:3,PersonID:null==d?void 0:d.EmpID,IssueId:n,StatusID:1}),m({Type:2,ISSUES_ID:n,USER_ID:null==b?void 0:b.EmpID})},[e]),c)?(0,a.jsxs)("div",{className:"container mx-auto py-8 px-4",children:[(0,a.jsx)("div",{className:"h-8 w-3/4 bg-muted animate-pulse rounded mb-4"}),(0,a.jsx)("div",{className:"h-4 w-1/2 bg-muted animate-pulse rounded mb-8"}),(0,a.jsx)("div",{className:"h-32 bg-muted animate-pulse rounded mb-8"})]}):u?(0,a.jsxs)("div",{className:"",children:[(0,a.jsx)(O,{isUpdate:e,setIsUpdate:s,sharedUsers:g,numberOfSolutions:(null==h?void 0:h.length)||0,issue:u}),(0,a.jsx)(eN,{isUpdate:e,setIsUpdate:s,issue:u}),(0,a.jsx)("br",{}),(0,a.jsx)("br",{}),(0,a.jsx)("br",{})]}):(0,a.jsxs)("div",{className:"px-4",children:[(0,a.jsxs)(r(),{href:"/dashboard/issues",className:"inline-flex items-center text-sm text-muted-foreground hover:text-foreground mb-4 sticky top-20 z-50",children:[(0,a.jsx)(j.A,{className:"mr-2 h-4 w-4"}),"Back to dashboard"]}),(0,a.jsx)("h1",{"data-view-transition-name":"page-title",className:"text-2xl font-bold mb-4",children:"Issue not found"}),(0,a.jsx)("p",{children:"The issue you're looking for doesn't exist or has been removed."})]})}},91394:(e,s,t)=>{"use strict";t.d(s,{BK:()=>d,eu:()=>r,q5:()=>o});var a=t(22342),l=t(33670),i=t(85977),n=t(59434);let r=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)(i.bL,{ref:s,className:(0,n.cn)("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",t),...l})});r.displayName=i.bL.displayName;let d=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)(i._V,{ref:s,className:(0,n.cn)("aspect-square h-full w-full",t),...l})});d.displayName=i._V.displayName;let o=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)(i.H4,{ref:s,className:(0,n.cn)("flex h-full w-full items-center justify-center rounded-full bg-muted",t),...l})});o.displayName=i.H4.displayName},98254:(e,s,t)=>{Promise.resolve().then(t.bind(t,80697))}},e=>{var s=s=>e(e.s=s);e.O(0,[1933,9268,8035,4404,417,586,9352,2243,1151,6874,6671,6956,5372,1892,704,760,715,4436,8384,462,5619,6708,4451,7358],()=>s(98254)),_N_E=e.O()}]);
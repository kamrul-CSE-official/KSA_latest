(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8169],{7374:()=>{},98169:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>k});var a=n(22342),s=n(33670),r=n(7501),o=n(39409),i=n(32990),d=n(6957),c=n(1565),l=n(97691),u=n(1069),m=n(4969),h=n(56183),p=n(56671),w=n(23464),g=n(2829),f=n(65424),x=n(35695),y=n(54052),v=n.n(y);let N=[{id:1,name:"MD.Kamrul Hasan"},{id:2,name:"Emon"},{id:3,name:"Ekram"},{id:4,name:"Raju"},{id:5,name:"Rahul"}];class b{static get isInline(){return!0}render(){let e=document.createElement(this.tag);return e.classList.add(this.className),e.contentEditable="false",e.dataset.mention="",e.innerText="@mention",e}handleKeyDown(e){"@"===e.key&&this.api.selection&&setTimeout(()=>{let e=window.getSelection();if(e&&e.rangeCount>0){let t=e.getRangeAt(0);this.showDropdown(t,"")}},10)}showDropdown(e,t){this.removeDropdown();let n=N.filter(e=>e.name.toLowerCase().includes(t.toLowerCase()));if(0===n.length)return;this.dropdown=document.createElement("div"),this.dropdown.classList.add("mention-dropdown"),n.forEach(t=>{let n=document.createElement("div");n.classList.add("mention-item"),n.innerText="@".concat(t.name),n.onclick=()=>this.insertMention(e,t),this.dropdown.appendChild(n)}),document.body.appendChild(this.dropdown);let a=e.getClientRects();if(a.length>0){let e=a[0];this.dropdown.style.left="".concat(e.left+window.scrollX,"px"),this.dropdown.style.top="".concat(e.bottom+window.scrollY,"px")}}insertMention(e,t){this.removeDropdown();let n=this.render();n.innerText="@".concat(t.name),n.dataset.mention=t.id.toString(),e.deleteContents(),e.insertNode(n),this.api.selection.expandToTag(n)}removeDropdown(){this.dropdown&&(this.dropdown.remove(),this.dropdown=null)}destroy(){document.removeEventListener("keydown",this.handleKeyDown)}renderInline(e){let t=document.createElement("span");return t.classList.add("mention-tag"),t.contentEditable="false",t.dataset.mention=e.id.toString(),t.innerText="@".concat(e.name),t}save(e){return{id:Number(e.dataset.mention),name:e.innerText.replace("@","")}}constructor({api:e}){this.tag="SPAN",this.className="mention-tag",this.dropdown=null,this.api=e,this.handleKeyDown=this.handleKeyDown.bind(this),document.addEventListener("keydown",this.handleKeyDown)}}b.sanitize={span:{class:!0,dataset:!0}};var A=n(51154),E=n(5196),D=n(4229);n(7374);var j=n(62136);let k=(0,s.memo)(function(e){let{initialData:t,onSave:n}=e,y=(0,s.useRef)(null),[N,k]=(0,s.useState)("idle"),[C,S]=(0,s.useState)(!1),T=(0,s.useRef)(!1),I=(0,s.useRef)(t),R=(0,x.useSearchParams)(),F=(0,j.Y)(R.get("workspaceId")||""),L=(0,j.Y)(R.get("ideaId")||""),[K]=(0,f.cO)(),P=(0,s.useCallback)(v()(async()=>{if(y.current)try{k("saving");let e=await y.current.save();await K({WorkSpaceID:Number(F),IdeaID:Number(L),Content:JSON.stringify(e)}),n&&n(e),k("saved"),setTimeout(()=>{k("idle")},2e3)}catch(e){console.error("Error saving document:",e),k("error"),p.oR.error("Failed to save changes",{description:"Your changes will be saved when connection is restored",duration:3e3})}},1e3),[K,F,L,n]),U=(0,s.useCallback)(()=>{P.cancel(),y.current&&"function"==typeof y.current.destroy&&(y.current.destroy(),y.current=null,T.current=!1)},[P]);return(0,s.useEffect)(()=>()=>{U()},[U]),(0,s.useEffect)(()=>{y.current&&(U(),T.current=!1),setTimeout(()=>{!T.current&&t&&(I.current=t,y.current=new r.A({holder:"editorjs",placeholder:"Write your ideas here...",autofocus:!0,data:t,onChange:()=>{P()},onReady:()=>{S(!0)},tools:{header:o.A,paragraph:c.A,list:i.A,table:{class:u.A,inlineToolbar:!0,config:{rows:2,cols:3,className:"custom-editor-table"}},mention:b,image:{class:h.A,config:{uploader:{async uploadByFile(e){try{let t=new FormData;t.append("file",e);let n=await w.A.post("".concat((0,g.AP)(),"/FileUpload/ImageUpload"),t,{headers:{"Content-Type":"multipart/form-data"}});return n.data?{success:1,file:{url:"".concat((0,g.AP)(),"/images/").concat(n.data)}}:{success:0}}catch(e){return console.error("Image upload error:",e),{success:0}}},async uploadByUrl(e){try{let t=await w.A.post("".concat((0,g.AP)(),"/FileUpload/ImageUpload"),{url:e});return t.data?{success:1,file:{url:"".concat((0,g.AP)(),"/images/").concat(t.data)}}:{success:0}}catch(e){return console.error("Image upload error:",e),{success:0}}}}}},quote:d.A,code:m.A,inlineCode:l.A}}),T.current=!0)},50)},[t,U,P]),(0,s.useEffect)(()=>()=>{U()},[U]),(0,a.jsxs)("div",{className:"relative rounded-md overflow-x-hidden",children:[(0,a.jsxs)("div",{className:"absolute top-2 right-2 z-10 flex items-center gap-2 px-3 py-1 rounded-full bg-background/80 backdrop-blur-sm text-sm overflow-x-hidden",children:["saving"===N&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(A.A,{className:"h-4 w-4 animate-spin text-muted-foreground"}),(0,a.jsx)("span",{className:"text-muted-foreground",children:"Saving..."})]}),"saved"===N&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(E.A,{className:"h-4 w-4 text-green-500"}),(0,a.jsx)("span",{className:"text-green-500",children:"Saved"})]}),"error"===N&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(D.A,{className:"h-4 w-4 text-red-500"}),(0,a.jsx)("span",{className:"text-red-500",children:"Retry saving..."})]})]}),(0,a.jsx)("div",{id:"editorjs",className:"p-4 min-h-[300px]"})]})},(e,t)=>JSON.stringify(e.initialData)===JSON.stringify(t.initialData))}}]);